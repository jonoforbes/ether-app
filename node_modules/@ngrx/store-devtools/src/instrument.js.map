{"version":3,"file":"instrument.js","sourceRoot":"","sources":["../../src/instrument.ts"],"names":[],"mappings":"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","sourcesContent":["import { NgModule, OpaqueToken, Injector, ModuleWithProviders } from '@angular/core';\nimport { StoreModule, State, INITIAL_STATE, INITIAL_REDUCER, Dispatcher, Reducer } from '@ngrx/store';\nimport { Observable } from 'rxjs/Observable';\nimport { StoreDevtools, DevtoolsDispatcher } from './devtools';\nimport { StoreDevtoolsConfig, STORE_DEVTOOLS_CONFIG } from './config';\nimport { DevtoolsExtension, REDUX_DEVTOOLS_EXTENSION } from './extension';\n\n\nexport function _createReduxDevtoolsExtension() {\n  const extensionKey = 'devToolsExtension';\n\n  if (typeof window === 'object' && typeof window[extensionKey] !== 'undefined') {\n    return window[extensionKey];\n  }\n\n  return null;\n}\n\nexport function _createState(devtools: StoreDevtools) {\n  return devtools.state;\n}\n\nexport function _createReducer(dispatcher: DevtoolsDispatcher, reducer) {\n  return new Reducer(dispatcher, reducer);\n}\n\nexport function _createStateIfExtension(extension: any, injector: Injector) {\n  if (!!extension) {\n    const devtools: StoreDevtools = injector.get(StoreDevtools);\n\n    return _createState(devtools);\n  }\n  else {\n    const initialState: any = injector.get(INITIAL_STATE);\n    const dispatcher: Dispatcher = injector.get(Dispatcher);\n    const reducer: Reducer = injector.get(Reducer);\n\n    return new State(initialState, dispatcher, reducer);\n  }\n}\n\nexport function _createReducerIfExtension(extension: any, injector: Injector) {\n  if (!!extension) {\n    const devtoolsDispatcher: DevtoolsDispatcher = injector.get(DevtoolsDispatcher);\n    const reducer: any = injector.get(INITIAL_REDUCER);\n\n    return _createReducer(devtoolsDispatcher, reducer);\n  }\n  else {\n    const dispatcher: Dispatcher = injector.get(Dispatcher);\n    const reducer: any = injector.get(INITIAL_REDUCER);\n\n    return new Reducer(dispatcher, reducer);\n  }\n}\n\nexport function _createExtensionOptions(): StoreDevtoolsConfig {\n  return {\n    maxAge: Infinity,\n    monitor: () => null\n  };\n}\n\n\nexport class StoreDevtoolsModule {\n  static instrumentStore(_options: StoreDevtoolsConfig = {}) {\n    const DEFAULT_OPTIONS: StoreDevtoolsConfig = {\n      monitor: () => null\n    };\n\n    const options = Object.assign({}, DEFAULT_OPTIONS, _options);\n\n    if (options.maxAge && options.maxAge < 2) {\n      throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${options.maxAge}`);\n    }\n\n    return {\n      ngModule: StoreDevtoolsModule,\n      providers: [\n        {\n          provide: State,\n          deps: [ StoreDevtools ],\n          useFactory: _createState\n        },\n        {\n          provide: Reducer,\n          deps: [ DevtoolsDispatcher, INITIAL_REDUCER ],\n          useFactory: _createReducer\n        },\n        { provide: STORE_DEVTOOLS_CONFIG, useValue: options }\n      ]\n    };\n  }\n\n  static instrumentOnlyWithExtension(): ModuleWithProviders {\n    return {\n      ngModule: StoreDevtoolsModule,\n      providers: [\n        {\n          provide: State,\n          deps: [ REDUX_DEVTOOLS_EXTENSION, Injector ],\n          useFactory: _createStateIfExtension\n        },\n        {\n          provide: Reducer,\n          deps: [ REDUX_DEVTOOLS_EXTENSION, Injector ],\n          useFactory: _createReducerIfExtension\n        },\n        {\n          provide: STORE_DEVTOOLS_CONFIG,\n          useFactory: _createExtensionOptions\n        }\n      ]\n    };\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n  imports: [\n    StoreModule\n  ],\n  providers: [\n    DevtoolsExtension,\n    DevtoolsDispatcher,\n    StoreDevtools,\n    {\n      provide: REDUX_DEVTOOLS_EXTENSION,\n      useFactory: _createReduxDevtoolsExtension\n    }\n  ]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}